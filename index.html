<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#050508">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Pleiades OS">
  <meta name="description" content="Your personal operating system ‚Äî many stars, each distinct, together something more">
  <title>Pleiades OS ‚ú¶ TJ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E‚ú¶%3C/text%3E%3C/svg%3E">
  <style>
    :root {
      --bg-primary: #050508;
      --bg-card: rgba(255, 255, 255, 0.03);
      --border-subtle: rgba(255, 255, 255, 0.06);
      --accent: #8b5cf6;
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.7);
      --text-muted: rgba(255, 255, 255, 0.5);
      --success: #10b981;
      --danger: #ef4444;
      --info: #3b82f6;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(236, 72, 153, 0.05) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(99, 102, 241, 0.03) 0%, transparent 70%);
      pointer-events: none;
      z-index: -1;
    }
    /* Starfield animation */
    .stars {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      z-index: -2;
      background-image:
        radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.15), transparent),
        radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.1), transparent),
        radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.12), transparent),
        radial-gradient(2px 2px at 130px 80px, rgba(255,255,255,0.08), transparent),
        radial-gradient(1px 1px at 160px 20px, rgba(255,255,255,0.1), transparent),
        radial-gradient(2px 2px at 200px 50px, rgba(255,255,255,0.06), transparent),
        radial-gradient(1px 1px at 250px 90px, rgba(255,255,255,0.08), transparent),
        radial-gradient(2px 2px at 300px 30px, rgba(255,255,255,0.1), transparent),
        radial-gradient(1px 1px at 350px 70px, rgba(255,255,255,0.05), transparent),
        radial-gradient(2px 2px at 400px 60px, rgba(255,255,255,0.08), transparent),
        radial-gradient(1px 1px at 450px 100px, rgba(255,255,255,0.06), transparent),
        radial-gradient(2px 2px at 500px 20px, rgba(255,255,255,0.1), transparent),
        radial-gradient(1px 1px at 550px 80px, rgba(255,255,255,0.08), transparent),
        radial-gradient(2px 2px at 600px 40px, rgba(255,255,255,0.06), transparent),
        radial-gradient(1px 1px at 650px 60px, rgba(255,255,255,0.1), transparent),
        radial-gradient(2px 2px at 700px 90px, rgba(255,255,255,0.05), transparent),
        radial-gradient(1px 1px at 750px 25px, rgba(255,255,255,0.08), transparent),
        radial-gradient(2px 2px at 800px 55px, rgba(255,255,255,0.06), transparent),
        radial-gradient(1px 1px at 850px 75px, rgba(255,255,255,0.1), transparent),
        radial-gradient(2px 2px at 900px 35px, rgba(255,255,255,0.08), transparent),
        radial-gradient(1px 1px at 950px 85px, rgba(255,255,255,0.05), transparent);
      background-size: 1000px 150px;
      animation: twinkle 8s ease-in-out infinite;
    }
    @keyframes twinkle {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 0.4; }
    }
    .header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(5, 5, 8, 0.85);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-subtle);
      padding: 1rem 2.5rem;
    }
    .header-content {
      max-width: 1600px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 600;
      font-size: 1.25rem;
    }
    .logo-icon {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--accent), #ec4899);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .nav-tabs {
      display: flex;
      gap: 0.5rem;
      background: rgba(255, 255, 255, 0.03);
      padding: 0.375rem;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
    }
    .nav-tab {
      padding: 0.625rem 1.25rem;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-family: inherit;
      font-size: 0.9rem;
      font-weight: 500;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .nav-tab:hover {
      color: var(--text-secondary);
      background: rgba(255, 255, 255, 0.05);
    }
    .nav-tab.active {
      color: var(--text-primary);
      background: rgba(139, 92, 246, 0.15);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
    }
    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .weather-widget {
      display: none;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 12px;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    .weather-widget.visible { display: flex; }
    .weather-widget .temp { font-weight: 600; color: var(--info); }
    .search-input {
      width: 200px;
      padding: 0.625rem 1rem;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.9rem;
    }
    .search-input:focus { outline: none; border-color: var(--accent); }
    .status-indicator {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.3s;
    }
    .status-indicator.online {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.2);
      color: var(--success);
    }
    .status-indicator.offline {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.2);
      color: var(--danger);
    }
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }
    .status-indicator.online .status-dot {
      background: var(--success);
      animation: pulse 2s infinite;
    }
    .status-indicator.offline .status-dot {
      background: var(--danger);
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.1); }
    }
    .main-content {
      max-width: 1600px;
      margin: 0 auto;
      padding: 2.5rem;
    }
    .tab-content { display: none; animation: fadeInUp 0.5s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .welcome-bar { margin-bottom: 2rem; }
    .welcome-title {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    .welcome-title span {
      background: linear-gradient(135deg, var(--accent), #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .welcome-subtitle { color: var(--text-secondary); font-size: 1rem; }
    .live-datetime { color: var(--accent); font-weight: 500; }
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2.5rem;
    }
    .metric-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.5rem;
      position: relative;
      transition: all 0.3s;
    }
    .metric-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent), #ec4899);
    }
    .metric-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }
    .metric-label {
      font-size: 0.875rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }
    .metric-value {
      font-size: 2.5rem;
      font-weight: 700;
    }
    .kanban-board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
    }
    .kanban-column {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.25rem;
      min-height: 500px;
    }
    .kanban-column-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-subtle);
    }
    .task-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      cursor: pointer;
      transition: all 0.3s;
    }
    .task-card:hover { 
      border-color: rgba(255,255,255,0.12);
      transform: translateY(-2px);
    }
    .task-priority {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      padding: 0.25rem 0.5rem;
      border-radius: 8px;
      display: inline-block;
      margin-top: 0.5rem;
    }
    .task-priority.high { background: rgba(239, 68, 68, 0.15); color: var(--danger); }
    .task-priority.medium { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
    .task-priority.low { background: rgba(16, 185, 129, 0.15); color: var(--success); }
    .add-task-btn {
      width: 100%;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.03);
      border: 1px dashed rgba(255,255,255,0.2);
      border-radius: 12px;
      color: var(--text-muted);
      font-family: inherit;
      cursor: pointer;
      transition: all 0.3s;
    }
    .add-task-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }
    .timeline { position: relative; padding-left: 2rem; }
    .timeline::before {
      content: '';
      position: absolute;
      left: 0; top: 0; bottom: 0;
      width: 2px;
      background: linear-gradient(180deg, var(--accent), transparent);
    }
    .timeline-phase {
      position: relative;
      margin-bottom: 2rem;
      padding-left: 2rem;
    }
    .timeline-phase::before {
      content: '';
      position: absolute;
      left: -2rem; top: 0.5rem;
      width: 12px; height: 12px;
      background: var(--accent);
      border-radius: 50%;
      border: 3px solid var(--bg-primary);
    }
    .notes-editor {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.5rem;
    }
    .notes-textarea {
      width: 100%;
      min-height: 500px;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-family: 'Inter', monospace;
      font-size: 0.95rem;
      line-height: 1.8;
      resize: vertical;
      outline: none;
    }

    /* ============================================
       COMMAND CENTER - AGENT STYLES
       ============================================ */
    .agents-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }
    .agent-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.5rem;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }
    .agent-card:hover {
      border-color: var(--accent);
      transform: translateY(-4px);
      box-shadow: 0 10px 40px rgba(139, 92, 246, 0.2);
    }
    .agent-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent), #ec4899);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .agent-card:hover::before { opacity: 1; }
    .agent-header {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .agent-avatar {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), #ec4899);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      flex-shrink: 0;
    }
    .agent-info { flex: 1; }
    .agent-name { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.25rem; }
    .agent-role { font-size: 0.85rem; color: var(--text-muted); }
    .agent-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.8rem;
      font-weight: 500;
      margin-top: 0.5rem;
    }
    .agent-status-dot { width: 8px; height: 8px; border-radius: 50%; }
    .agent-status.online .agent-status-dot { background: var(--success); }
    .agent-status.busy .agent-status-dot { background: var(--warning); }
    .agent-status.offline .agent-status-dot { background: var(--danger); }
    .agent-status.online { color: var(--success); }
    .agent-status.busy { color: var(--warning); }
    .agent-status.offline { color: var(--danger); }
    .agent-meta {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-subtle);
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .agent-model { color: var(--accent); font-weight: 500; }
    .slide-panel {
      position: fixed;
      top: 0;
      right: -450px;
      width: 450px;
      height: 100vh;
      background: var(--bg-primary);
      border-left: 1px solid var(--border-subtle);
      z-index: 2000;
      transition: right 0.3s ease;
      overflow-y: auto;
      box-shadow: -10px 0 40px rgba(0,0,0,0.5);
    }
    .slide-panel.open { right: 0; }
    .slide-panel-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }
    .slide-panel-overlay.open { opacity: 1; visibility: visible; }
    .slide-panel-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--border-subtle);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .slide-panel-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
    }
    .slide-panel-content { padding: 1.5rem; }
    .agent-detail-section { margin-bottom: 2rem; }
    .agent-detail-section h3 {
      font-size: 0.875rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }
    .agent-detail-section ul { list-style: none; }
    .agent-detail-section li {
      padding: 0.375rem 0;
      padding-left: 1.25rem;
      position: relative;
      color: var(--text-secondary);
    }
    .agent-detail-section li::before {
      content: '‚Üí';
      position: absolute;
      left: 0;
      color: var(--accent);
    }
    .agent-activity-log {
      background: rgba(255,255,255,0.02);
      border-radius: 12px;
      padding: 1rem;
      max-height: 200px;
      overflow-y: auto;
    }
    .activity-entry {
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border-subtle);
      font-size: 0.85rem;
    }
    .activity-entry:last-child { border-bottom: none; }
    .activity-time { color: var(--text-muted); font-size: 0.75rem; }
    .send-task-btn {
      width: 100%;
      padding: 0.875rem;
      background: var(--accent);
      border: none;
      border-radius: 12px;
      color: white;
      font-family: inherit;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 1rem;
    }
    .send-task-btn:hover {
      background: #7c3aed;
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
    }
    .decisions-section { margin-top: 3rem; }
    .decisions-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }
    .decisions-title { font-size: 1.25rem; font-weight: 600; }
    .decision-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.25rem;
      margin-bottom: 1rem;
    }
    .decision-date { font-size: 0.8rem; color: var(--accent); margin-bottom: 0.5rem; }
    .decision-question { font-weight: 600; margin-bottom: 0.5rem; }
    .decision-summary { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.75rem; }
    .decision-agents { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .decision-agent-tag {
      background: rgba(139, 92, 246, 0.1);
      color: var(--accent);
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
    }
    .modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(5px);
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-overlay.open { opacity: 1; visibility: visible; }
    .modal {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 2rem;
      width: 90%;
      max-width: 500px;
      transform: scale(0.95);
      transition: transform 0.3s;
    }
    .modal-overlay.open .modal { transform: scale(1); }
    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }
    .modal-title { font-size: 1.25rem; font-weight: 600; }
    .modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
    }
    .modal-textarea {
      width: 100%;
      min-height: 150px;
      padding: 1rem;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.95rem;
      resize: vertical;
      outline: none;
      margin-bottom: 1rem;
    }
    .modal-textarea:focus { border-color: var(--accent); }
    .modal-actions { display: flex; gap: 1rem; }
    .modal-btn {
      flex: 1;
      padding: 0.75rem;
      border-radius: 12px;
      font-family: inherit;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      border: none;
    }
    .modal-btn-primary { background: var(--accent); color: white; }
    .modal-btn-secondary { background: rgba(255,255,255,0.1); color: var(--text-secondary); }
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      padding: 1rem 1.5rem;
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      font-size: 0.9rem;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s;
      z-index: 3000;
    }
    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }
    .toast.success { border-left: 3px solid var(--success); }
    .toast.error { border-left: 3px solid var(--danger); }

    /* ============================================
       MEETINGS TAB STYLES
       ============================================ */
    .meetings-section { margin-bottom: 3rem; }
    .meetings-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }
    .meetings-title {
      font-size: 1.25rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .meetings-count {
      background: var(--accent);
      color: white;
      font-size: 0.75rem;
      padding: 0.25rem 0.625rem;
      border-radius: 9999px;
    }
    .meetings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1rem;
    }
    .meeting-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      overflow: hidden;
      transition: all 0.3s;
    }
    .meeting-card:hover {
      border-color: var(--accent);
      box-shadow: 0 10px 40px rgba(139, 92, 246, 0.15);
    }
    .meeting-card.today {
      border-color: var(--accent);
      box-shadow: 0 0 30px rgba(139, 92, 246, 0.2);
    }
    .meeting-card.today::before {
      content: 'TODAY';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--accent);
      color: white;
      font-size: 0.65rem;
      font-weight: 600;
      padding: 0.25rem 0.75rem;
      border-radius: 0 0 0 8px;
    }
    .meeting-card-header {
      padding: 1.25rem;
      cursor: pointer;
      position: relative;
    }
    .meeting-card-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.75rem;
    }
    .meeting-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      padding-right: 1rem;
    }
    .meeting-datetime {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
    }
    .meeting-countdown {
      background: rgba(139, 92, 246, 0.15);
      color: var(--accent);
      padding: 0.375rem 0.75rem;
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 500;
      font-variant-numeric: tabular-nums;
    }
    .meeting-countdown.urgent {
      background: rgba(245, 158, 11, 0.15);
      color: var(--warning);
      animation: pulse 2s infinite;
    }
    .meeting-meta {
      display: flex;
      gap: 1rem;
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .meeting-type {
      display: flex;
      align-items: center;
      gap: 0.375rem;
    }
    .meeting-attendees {
      display: flex;
      align-items: center;
      gap: 0.375rem;
    }
    .meeting-actions {
      display: flex;
      gap: 0.5rem;
    }
    .meeting-btn {
      background: rgba(255,255,255,0.05);
      border: none;
      color: var(--text-muted);
      padding: 0.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 1rem;
    }
    .meeting-btn:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text-primary);
    }
    .meeting-btn.delete:hover {
      background: rgba(239, 68, 68, 0.15);
      color: var(--danger);
    }
    .meeting-expanded {
      border-top: 1px solid var(--border-subtle);
      padding: 1.25rem;
      display: none;
    }
    .meeting-expanded.open { display: block; }
    .meeting-section {
      margin-bottom: 1.5rem;
    }
    .meeting-section:last-child { margin-bottom: 0; }
    .meeting-section-title {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }
    .agenda-list { list-style: none; }
    .agenda-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border-subtle);
    }
    .agenda-item:last-child { border-bottom: none; }
    .agenda-checkbox {
      width: 18px;
      height: 18px;
      border: 2px solid var(--border-subtle);
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    .agenda-checkbox:hover { border-color: var(--accent); }
    .agenda-checkbox.checked {
      background: var(--accent);
      border-color: var(--accent);
    }
    .agenda-checkbox.checked::after {
      content: '‚úì';
      color: white;
      font-size: 0.75rem;
    }
    .agenda-text {
      flex: 1;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    .agenda-text.completed {
      text-decoration: line-through;
      color: var(--text-muted);
    }
    .agenda-input {
      flex: 1;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      padding: 0.5rem;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.9rem;
    }
    .agenda-input:focus { outline: none; border-color: var(--accent); }
    .add-agenda-btn {
      width: 100%;
      padding: 0.625rem;
      background: rgba(255,255,255,0.03);
      border: 1px dashed rgba(255,255,255,0.2);
      border-radius: 8px;
      color: var(--text-muted);
      font-family: inherit;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 0.5rem;
    }
    .add-agenda-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }
    .meeting-notes-area {
      width: 100%;
      min-height: 100px;
      padding: 0.75rem;
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.9rem;
      resize: vertical;
      outline: none;
    }
    .meeting-notes-area:focus { border-color: var(--accent); }
    .action-items-list { list-style: none; }
    .action-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.625rem;
      background: rgba(16, 185, 129, 0.08);
      border: 1px solid rgba(16, 185, 129, 0.2);
      border-radius: 8px;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    .action-item-input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.9rem;
      outline: none;
    }
    .action-item-input::placeholder { color: var(--text-muted); }
    .add-action-item {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .add-action-input {
      flex: 1;
      padding: 0.625rem;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.9rem;
    }
    .add-action-input:focus { outline: none; border-color: var(--accent); }
    .add-action-btn {
      padding: 0.625rem 1rem;
      background: var(--accent);
      border: none;
      border-radius: 8px;
      color: white;
      font-family: inherit;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .add-action-btn:hover { background: #7c3aed; }
    .no-meetings {
      text-align: center;
      padding: 3rem;
      color: var(--text-muted);
    }
    .archive-toggle {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 0.9rem;
      margin-top: 2rem;
      padding: 0.75rem;
      border-radius: 8px;
      transition: all 0.2s;
    }
    .archive-toggle:hover {
      background: rgba(255,255,255,0.05);
      color: var(--text-secondary);
    }
    .archive-section { display: none; }
    .archive-section.open { display: block; }
    .meeting-card.past { opacity: 0.7; }

    /* ============================================
       INTEL TAB STYLES
       ============================================ */
    .intel-container { display: grid; grid-template-columns: 280px 1fr; gap: 2rem; }
    .intel-sidebar {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.5rem;
      height: fit-content;
      position: sticky;
      top: 100px;
    }
    .intel-filters-title {
      font-size: 0.875rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 1rem;
    }
    .intel-filter-group { margin-bottom: 1.5rem; }
    .intel-filter-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
      display: block;
    }
    .intel-filter-btn {
      width: 100%;
      padding: 0.625rem 1rem;
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      color: var(--text-secondary);
      font-family: inherit;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 0.5rem;
      text-align: left;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .intel-filter-btn:hover {
      background: rgba(255,255,255,0.06);
      border-color: rgba(255,255,255,0.1);
    }
    .intel-filter-btn.active {
      background: rgba(139, 92, 246, 0.15);
      border-color: var(--accent);
      color: var(--text-primary);
    }
    .intel-filter-count {
      margin-left: auto;
      background: rgba(255,255,255,0.1);
      padding: 0.125rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.75rem;
    }
    .intel-main { min-width: 0; }
    .intel-section { margin-bottom: 2.5rem; }
    .intel-section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }
    .intel-section-title {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .intel-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1rem;
    }
    .intel-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 1.25rem;
      transition: all 0.3s;
      position: relative;
    }
    .intel-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 10px 40px rgba(139, 92, 246, 0.1);
    }
    .intel-card.hot { border-left: 3px solid #ef4444; }
    .intel-card.notable { border-left: 3px solid #f59e0b; }
    .intel-card.reference { border-left: 3px solid #3b82f6; }
    .intel-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.75rem;
    }
    .intel-importance {
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.25rem 0.625rem;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    .intel-importance.hot { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
    .intel-importance.notable { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
    .intel-importance.reference { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
    .intel-category-tag {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-muted);
      background: rgba(255,255,255,0.05);
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
    }
    .intel-title {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      line-height: 1.4;
    }
    .intel-title a {
      color: var(--text-primary);
      text-decoration: none;
      transition: color 0.2s;
    }
    .intel-title a:hover { color: var(--accent); }
    .intel-summary {
      color: var(--text-secondary);
      font-size: 0.9rem;
      line-height: 1.6;
      margin-bottom: 1rem;
    }
    .intel-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .intel-date { display: flex; align-items: center; gap: 0.375rem; }
    .intel-source {
      color: var(--accent);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.375rem;
      transition: opacity 0.2s;
    }
    .intel-source:hover { opacity: 0.8; }
    .intel-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-subtle);
    }
    .intel-btn {
      padding: 0.5rem 1rem;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      color: var(--text-secondary);
      font-family: inherit;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .intel-btn:hover {
      background: rgba(255,255,255,0.1);
      border-color: rgba(255,255,255,0.15);
      color: var(--text-primary);
    }
    .intel-btn.delete:hover {
      background: rgba(239, 68, 68, 0.15);
      border-color: rgba(239, 68, 68, 0.3);
      color: #ef4444;
    }
    .daily-brief-card {
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05));
      border: 1px solid rgba(139, 92, 246, 0.3);
    }
    .daily-brief-card:hover {
      border-color: var(--accent);
      box-shadow: 0 10px 40px rgba(139, 92, 246, 0.2);
    }
    .no-intel {
      text-align: center;
      padding: 3rem;
      color: var(--text-muted);
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
    }
    @media (max-width: 1024px) {
      .intel-container { grid-template-columns: 1fr; }
      .intel-sidebar { position: static; }
    }

    @media (max-width: 768px) {
      .header { padding: 0.75rem 1rem; }
      .header-content {
        flex-wrap: wrap;
        gap: 0.75rem;
      }
      .logo { font-size: 1rem; }
      .logo-icon { width: 32px; height: 32px; }
      .nav-tabs {
        order: 3;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        padding: 0.25rem;
        gap: 0.25rem;
      }
      .nav-tab {
        padding: 0.5rem 0.875rem;
        font-size: 0.8rem;
        white-space: nowrap;
        flex-shrink: 0;
      }
      .header-right {
        order: 2;
        gap: 0.5rem;
      }
      .search-input { width: 120px; padding: 0.5rem; font-size: 0.8rem; }
      .status-indicator { padding: 0.375rem 0.75rem; font-size: 0.75rem; }
      .main-content { padding: 1rem; }
      .welcome-title { font-size: 1.5rem; }
      .welcome-subtitle { font-size: 0.9rem; }
      .metrics-grid { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
      .metric-value { font-size: 1.75rem; }
      .metric-label { font-size: 0.75rem; }
      .kanban-board { grid-template-columns: 1fr; }
      .agents-grid { grid-template-columns: 1fr; }
      .meetings-grid { grid-template-columns: 1fr; }
      .intel-grid { grid-template-columns: 1fr; }
      .slide-panel { width: 100%; right: -100%; }
      .weather-widget { display: none !important; }
      .timeline { padding-left: 1rem; }
      .timeline-phase { padding-left: 1.5rem; }
      .notes-textarea { min-height: 300px; }
      .modal { padding: 1.5rem; margin: 1rem; }
    }
    @media (max-width: 480px) {
      .metrics-grid { grid-template-columns: 1fr; }
      .nav-tab { padding: 0.5rem 0.625rem; font-size: 0.75rem; }
    }
    /* Touch feedback */
    @media (hover: none) {
      .nav-tab:active, .task-card:active, .agent-card:active, .meeting-card:active, .intel-card:active {
        transform: scale(0.98);
        opacity: 0.9;
      }
      .add-task-btn:active, .send-task-btn:active, .modal-btn-primary:active {
        transform: scale(0.97);
      }
    }
    /* Safe area for notched phones */
    @supports (padding-top: env(safe-area-inset-top)) {
      .header {
        padding-top: calc(1rem + env(safe-area-inset-top));
        padding-left: calc(2.5rem + env(safe-area-inset-left));
        padding-right: calc(2.5rem + env(safe-area-inset-right));
      }
      @media (max-width: 768px) {
        .header {
          padding-left: calc(1rem + env(safe-area-inset-left));
          padding-right: calc(1rem + env(safe-area-inset-right));
        }
      }
    }
  </style>
</head>
<body>
  <div class="stars"></div>
  <div id="app-loader" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-primary); display: flex; align-items: center; justify-content: center; z-index: 10000; transition: opacity 0.5s;">
    <div style="text-align: center;">
      <div style="font-size: 4rem; margin-bottom: 1rem; animation: pulse 2s infinite;">‚ú¶</div>
      <div style="color: var(--text-secondary); font-size: 1.25rem;">Pleiades OS</div>
      <div style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.5rem;">Awakening...</div>
    </div>
  </div>
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">‚ú¶</div>
        <span>Pleiades OS</span>
      </div>
      <nav class="nav-tabs">
        <button class="nav-tab active" data-tab="dashboard">‚ú® Today</button>
        <button class="nav-tab" data-tab="projects">üéØ Path</button>
        <button class="nav-tab" data-tab="command">üåü Collective</button>
        <button class="nav-tab" data-tab="meetings">üìû Rituals</button>
        <button class="nav-tab" data-tab="intel">üì° Signals</button>
        <button class="nav-tab" data-tab="timeline">üåô Journey</button>
        <button class="nav-tab" data-tab="notes">üìù Field Notes</button>
      </nav>
      <div class="header-right">
        <div class="weather-widget" id="weatherWidget">
          <span id="weatherIcon">üå§</span>
          <span class="temp" id="weatherTemp">--¬∞C</span>
          <span id="weatherCondition">--</span>
        </div>
        <input type="text" class="search-input" placeholder="Search..." id="globalSearch">
        <div class="status-indicator offline" id="serverStatus">
          <div class="status-dot"></div>
          <span id="serverStatusText">Constellation: Disconnected</span>
        </div>
      </div>
    </div>
  </header>

  <main class="main-content">
    <div class="tab-content active" id="dashboard">
      <div class="welcome-bar">
        <h1 class="welcome-title">Hey <span id="greeting">morning</span> star ‚ú¶</h1>
        <p class="welcome-subtitle">It's <span class="live-datetime" id="currentDateTime"></span> ‚Äî another step toward home</p>
        <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.5rem; font-style: italic;">"Many stars, each distinct, together something more"</p>
      </div>
      <div class="metrics-grid">
        <div class="metric-card">
          <div class="metric-label">Path to Permanence</div>
          <div class="metric-value" id="goalProgress">0%</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">In Motion</div>
          <div class="metric-value" id="activeProjects">0</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">Open Threads</div>
          <div class="metric-value" id="tasksToday">0</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">Orbits to Home</div>
          <div class="metric-value" id="daysToGoal">--</div>
        </div>
      </div>
    </div>

    <!-- COMMAND CENTER TAB -->
    <div class="tab-content" id="command">
      <div class="welcome-bar">
        <h1 class="welcome-title">üåü The Collective</h1>
        <p class="welcome-subtitle">Your constellation of agents ‚Äî distinct voices, shared purpose</p>
      </div>
      <div class="agents-grid" id="agentsGrid"></div>
      <div class="decisions-section">
        <div class="decisions-header">
          <h2 class="decisions-title">üìã Executive Decisions</h2>
          <button class="add-task-btn" onclick="addNewDecision()">+ Log Decision</button>
        </div>
        <div id="decisionsList"></div>
      </div>
    </div>

    <!-- PATH TAB (Projects) -->
    <div class="tab-content" id="projects">
      <div class="welcome-bar">
        <h1 class="welcome-title">üéØ The Path</h1>
        <p class="welcome-subtitle">What you're carrying ‚Äî the weight and the way forward</p>
      </div>
      <div class="kanban-board">
        <div class="kanban-column">
          <div class="kanban-column-header">
            <strong>üåë Gathering</strong>
            <span class="kanban-count" id="count-backlog">0</span>
          </div>
          <div id="backlog-tasks"></div>
          <button class="add-task-btn" onclick="addNewTask('backlog')">+ Add to gathering</button>
        </div>
        <div class="kanban-column">
          <div class="kanban-column-header">
            <strong>‚ú® In Motion</strong>
            <span class="kanban-count" id="count-inprogress">0</span>
          </div>
          <div id="inprogress-tasks"></div>
          <button class="add-task-btn" onclick="addNewTask('inprogress')">+ Start moving</button>
        </div>
        <div class="kanban-column">
          <div class="kanban-column-header">
            <strong>üåü Transformed</strong>
            <span class="kanban-count" id="count-done">0</span>
          </div>
          <div id="done-tasks"></div>
          <button class="add-task-btn" onclick="addNewTask('done')">+ Mark complete</button>
        </div>
      </div>
    </div>

    <!-- MEETINGS TAB -->
    <div class="tab-content" id="meetings">
      <div class="welcome-bar">
        <h1 class="welcome-title">üìû Rituals</h1>
        <p class="welcome-subtitle">Sacred gatherings ‚Äî interviews, board meetings, coffee with possibility</p>
      </div>

      <!-- Today's Meetings -->
      <div class="meetings-section" id="todayMeetingsSection" style="display: none;">
        <div class="meetings-header">
          <h2 class="meetings-title">üî• This Orbit <span class="meetings-count" id="todayMeetingsCount">0</span></h2>
        </div>
        <div class="meetings-grid" id="todayMeetingsGrid"></div>
      </div>

      <!-- Upcoming Meetings -->
      <div class="meetings-section">
        <div class="meetings-header">
          <h2 class="meetings-title">üåô Approaching <span class="meetings-count" id="upcomingMeetingsCount">0</span></h2>
          <button class="add-task-btn" onclick="openMeetingModal()">+ Add Meeting</button>
        </div>
        <div class="meetings-grid" id="upcomingMeetingsGrid"></div>
        <div class="no-meetings" id="noMeetingsMsg" style="display: none;">
          No upcoming meetings. Add one to get started!
        </div>
      </div>

      <!-- Archive -->
      <div class="archive-toggle" onclick="toggleArchive()">
        <span id="archiveIcon">‚ñ∂</span>
        <span>Archive (<span id="archiveCount">0</span> past meetings)</span>
      </div>
      <div class="archive-section" id="archiveSection">
        <div class="meetings-grid" id="archiveMeetingsGrid"></div>
      </div>
    </div>

    <!-- INTEL TAB -->
    <div class="tab-content" id="intel">
      <div class="welcome-bar">
        <h1 class="welcome-title">üì° Signals</h1>
        <p class="welcome-subtitle">What the universe is whispering ‚Äî opportunities, shifts, warnings</p>
      </div>
      <div class="intel-container">
        <!-- Sidebar Filters -->
        <aside class="intel-sidebar">
          <div class="intel-filters-title">üéØ Filters</div>
          
          <div class="intel-filter-group">
            <span class="intel-filter-label">Category</span>
            <button class="intel-filter-btn active" data-filter="category" data-value="all" onclick="setIntelFilter('category', 'all')">
              üìÅ All Categories
              <span class="intel-filter-count" id="count-all">0</span>
            </button>
            <button class="intel-filter-btn" data-filter="category" data-value="ai-news" onclick="setIntelFilter('category', 'ai-news')">
              ü§ñ AI News
              <span class="intel-filter-count" id="count-ai-news">0</span>
            </button>
            <button class="intel-filter-btn" data-filter="category" data-value="industry" onclick="setIntelFilter('category', 'industry')">
              üìà Industry Trends
              <span class="intel-filter-count" id="count-industry">0</span>
            </button>
            <button class="intel-filter-btn" data-filter="category" data-value="competitor" onclick="setIntelFilter('category', 'competitor')">
              üëÅ Competitor Watch
              <span class="intel-filter-count" id="count-competitor">0</span>
            </button>
            <button class="intel-filter-btn" data-filter="category" data-value="opportunities" onclick="setIntelFilter('category', 'opportunities')">
              üí° Opportunities
              <span class="intel-filter-count" id="count-opportunities">0</span>
            </button>
          </div>

          <div class="intel-filter-group">
            <span class="intel-filter-label">Importance</span>
            <button class="intel-filter-btn active" data-filter="importance" data-value="all" onclick="setIntelFilter('importance', 'all')">
              üéØ All
            </button>
            <button class="intel-filter-btn" data-filter="importance" data-value="hot" onclick="setIntelFilter('importance', 'hot')">
              üî• Hot
            </button>
            <button class="intel-filter-btn" data-filter="importance" data-value="notable" onclick="setIntelFilter('importance', 'notable')">
              ‚ö°Ô∏è Notable
            </button>
            <button class="intel-filter-btn" data-filter="importance" data-value="reference" onclick="setIntelFilter('importance', 'reference')">
              üìå Reference
            </button>
          </div>

          <button class="send-task-btn" onclick="openIntelModal()" style="margin-top: 1rem;">+ Add Intel</button>
        </aside>

        <!-- Main Content -->
        <main class="intel-main">
          <!-- Daily Brief -->
          <div class="intel-section" id="dailyBriefSection">
            <div class="intel-section-header">
              <h2 class="intel-section-title">üì∞ Daily Brief</h2>
              <span style="font-size: 0.85rem; color: var(--text-muted);">Top 5 most important</span>
            </div>
            <div class="intel-grid" id="dailyBriefGrid"></div>
          </div>

          <!-- All Intel -->
          <div class="intel-section">
            <div class="intel-section-header">
              <h2 class="intel-section-title" id="intelListTitle">üìä All Intel</h2>
              <span style="font-size: 0.85rem; color: var(--text-muted);" id="intelListCount">0 items</span>
            </div>
            <div class="intel-grid" id="intelGrid"></div>
            <div class="no-intel" id="noIntelMsg" style="display: none;">
              No intel items match your filters. Add some intelligence!
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- JOURNEY TAB -->
    <div class="tab-content" id="timeline">
      <div class="welcome-bar">
        <h1 class="welcome-title">üåô The Journey</h1>
        <p class="welcome-subtitle">Where you've been, where you're going, the path home</p>
      </div>
      <div class="timeline">
        <div class="timeline-phase">
          <h3>‚ú¶ Arrival & Anchor</h3>
          <p style="color: var(--text-secondary);">Landing in Canada, finding footing, building first threads</p>
        </div>
        <div class="timeline-phase">
          <h3>‚ú¶ The Hustle</h3>
          <p style="color: var(--text-secondary);">Multiple jobs, volunteering, proving value, filling time</p>
        </div>
        <div class="timeline-phase">
          <h3>‚ú¶ The Bridge</h3>
          <p style="color: var(--text-secondary);">Now ‚Äî grad school apps, permanent residency, full-time work</p>
        </div>
        <div class="timeline-phase">
          <h3>‚ú¶ Home</h3>
          <p style="color: var(--text-secondary);">Permanent residency, stability, room to breathe and build</p>
        </div>
      </div>
    </div>

    <!-- FIELD NOTES TAB -->
    <div class="tab-content" id="notes">
      <div class="welcome-bar">
        <h1 class="welcome-title">üìù Field Notes</h1>
        <p class="welcome-subtitle">Unstructured thoughts, observations, fragments of insight</p>
      </div>
      <div class="notes-editor">
        <textarea class="notes-textarea" id="notesArea" placeholder="What's on your mind? The noise, the clarity, the in-between..."></textarea>
      </div>
    </div>

  <!-- Slide-out Panel -->
  <div class="slide-panel-overlay" id="slideOverlay" onclick="closeSlidePanel()"></div>
  <div class="slide-panel" id="slidePanel">
    <div class="slide-panel-header">
      <h2>‚ú¶ Aspect of the Collective</h2>
      <button class="slide-panel-close" onclick="closeSlidePanel()">&times;</button>
    </div>
    <div class="slide-panel-content" id="slidePanelContent"></div>
  </div>

  <!-- Send Task Modal -->
  <div class="modal-overlay" id="taskModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Send a Whisper</h3>
        <button class="modal-close" onclick="closeTaskModal()">&times;</button>
      </div>
      <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 1rem;">What do you need from this part of yourself?</p>
      <textarea class="modal-textarea" id="taskMessage" placeholder="Describe what you need..."></textarea>
      <div class="modal-actions">
        <button class="modal-btn modal-btn-secondary" onclick="closeTaskModal()">Nevermind</button>
        <button class="modal-btn modal-btn-primary" onclick="submitTask()">Send</button>
      </div>
    </div>
  </div>

  <!-- Meeting Modal -->
  <div class="modal-overlay" id="meetingModal">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header">
        <h3 class="modal-title" id="meetingModalTitle">Add a Ritual</h3>
        <button class="modal-close" onclick="closeMeetingModal()">&times;</button>
      </div>
      <input type="hidden" id="meetingId">
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Title</label>
        <input type="text" class="modal-textarea" id="meetingTitle" placeholder="Meeting title" style="min-height: auto; padding: 0.75rem;">
      </div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
        <div>
          <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Date</label>
          <input type="date" class="modal-textarea" id="meetingDate" style="min-height: auto; padding: 0.75rem;">
        </div>
        <div>
          <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Time</label>
          <input type="time" class="modal-textarea" id="meetingTime" style="min-height: auto; padding: 0.75rem;">
        </div>
      </div>
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Type</label>
        <select class="modal-textarea" id="meetingType" style="min-height: auto; padding: 0.75rem; cursor: pointer;">
          <option value="call">üìû Phone Call</option>
          <option value="zoom">üíª Zoom/Video</option>
          <option value="in-person">ü§ù In-Person</option>
        </select>
      </div>
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Attendees</label>
        <input type="text" class="modal-textarea" id="meetingAttendees" placeholder="Names separated by commas" style="min-height: auto; padding: 0.75rem;">
      </div>
      <div style="margin-bottom: 1.5rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Prep Notes</label>
        <textarea class="modal-textarea" id="meetingPrepNotes" placeholder="Preparation notes..."></textarea>
      </div>
      <div class="modal-actions">
        <button class="modal-btn modal-btn-secondary" onclick="closeMeetingModal()">Cancel</button>
        <button class="modal-btn modal-btn-primary" onclick="saveMeeting()">Save Ritual</button>
      </div>
    </div>
  </div>

  <!-- Intel Modal -->
  <div class="modal-overlay" id="intelModal">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header">
        <h3 class="modal-title" id="intelModalTitle">Add Intel</h3>
        <button class="modal-close" onclick="closeIntelModal()">&times;</button>
      </div>
      <input type="hidden" id="intelId">
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Title</label>
        <input type="text" class="modal-textarea" id="intelTitle" placeholder="Intel item title" style="min-height: auto; padding: 0.75rem;">
      </div>
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Category</label>
        <select class="modal-textarea" id="intelCategory" style="min-height: auto; padding: 0.75rem; cursor: pointer;">
          <option value="ai-news">ü§ñ AI News</option>
          <option value="industry">üìà Industry Trends</option>
          <option value="competitor">üëÅ Competitor Watch</option>
          <option value="opportunities">üí° Opportunities</option>
        </select>
      </div>
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Importance</label>
        <select class="modal-textarea" id="intelImportance" style="min-height: auto; padding: 0.75rem; cursor: pointer;">
          <option value="hot">üî• Hot - Critical/Urgent</option>
          <option value="notable">‚ö°Ô∏è Notable - Important</option>
          <option value="reference">üìå Reference - Good to know</option>
        </select>
      </div>
      <div style="margin-bottom: 1rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Source URL</label>
        <input type="url" class="modal-textarea" id="intelSource" placeholder="https://..." style="min-height: auto; padding: 0.75rem;">
      </div>
      <div style="margin-bottom: 1.5rem;">
        <label style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.375rem;">Summary</label>
        <textarea class="modal-textarea" id="intelSummary" placeholder="Brief summary of the intel..." style="min-height: 120px;"></textarea>
      </div>
      <div class="modal-actions">
        <button class="modal-btn modal-btn-secondary" onclick="closeIntelModal()">Cancel</button>
        <button class="modal-btn modal-btn-primary" onclick="saveIntel()">Save Intel</button>
      </div>
    </div>
  </div>

  </main>

  <div class="toast" id="toast"></div>

  <script>
    // ============================================
    // CONFIGURATION
    // ============================================
    const API_BASE = 'http://localhost:8899';
    const SYNC_INTERVAL = 5 * 60 * 1000; // 5 minutes
    const HEARTBEAT_INTERVAL = 30 * 1000; // 30 seconds

    // ============================================
    // STATE MANAGEMENT
    // ============================================
    const AppState = {
      isOnline: false,
      lastSync: null,
      tasks: [],
      notes: '',
      pendingSync: false,
      syncQueue: []
    };

    // LocalStorage wrapper
    const Storage = {
      get(key, defaultValue = null) {
        try {
          const item = localStorage.getItem(key);
          return item ? JSON.parse(item) : defaultValue;
        } catch(e) { return defaultValue; }
      },
      set(key, value) {
        try {
          localStorage.setItem(key, JSON.stringify(value));
          return true;
        } catch(e) { return false; }
      }
    };

    // ============================================
    // SERVER COMMUNICATION
    // ============================================
    async function fetchFromServer(endpoint, options = {}) {
      try {
        const response = await fetch(`${API_BASE}${endpoint}`, {
          ...options,
          headers: { 'Content-Type': 'application/json', ...options.headers }
        });
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        return await response.json();
      } catch (error) {
        throw error;
      }
    }

    // Check server status
    async function checkServerStatus() {
      try {
        const data = await fetchFromServer('/mc/status');
        if (data.health === 'online') {
          setServerStatus(true);
          processSyncQueue();
          return true;
        }
      } catch (error) {
        setServerStatus(false);
      }
      return false;
    }

    function setServerStatus(online) {
      AppState.isOnline = online;
      const indicator = document.getElementById('serverStatus');
      const text = document.getElementById('serverStatusText');
      
      if (online) {
        indicator.classList.remove('offline');
        indicator.classList.add('online');
        text.textContent = 'Constellation: Connected';
      } else {
        indicator.classList.remove('online');
        indicator.classList.add('offline');
        text.textContent = 'Constellation: Local';
      }
    }

    // ============================================
    // DATA SYNCHRONIZATION
    // ============================================
    
    // Load data from server on boot
    async function loadInitialData() {
      try {
        const serverData = await fetchFromServer('/mc/data');
        const localTasks = Storage.get('mc_tasks', []);
        const localNotes = Storage.get('mc_notes', '');
        
        // Server is source of truth for backups - merge missing data
        if (serverData.tasks && localTasks.length === 0) {
          AppState.tasks = serverData.tasks;
          Storage.set('mc_tasks', AppState.tasks);
        } else {
          AppState.tasks = localTasks.length > 0 ? localTasks : getDefaultTasks();
        }
        
        if (serverData.notes && !localNotes) {
          AppState.notes = serverData.notes;
          Storage.set('mc_notes', AppState.notes);
        } else {
          AppState.notes = localNotes || '';
        }
        
        showToast('Synced with server', 'success');
      } catch (error) {
        // Fallback to localStorage
        AppState.tasks = Storage.get('mc_tasks', getDefaultTasks());
        AppState.notes = Storage.get('mc_notes', '');
        showToast('Running in offline mode', 'error');
      }
      
      renderAll();
    }

    // Backup to server
    async function syncToServer() {
      if (!AppState.isOnline) {
        AppState.pendingSync = true;
        return;
      }
      
      try {
        const data = {
          tasks: AppState.tasks,
          notes: AppState.notes,
          lastSync: new Date().toISOString()
        };
        
        await fetchFromServer('/mc/data', {
          method: 'POST',
          body: JSON.stringify(data)
        });
        
        AppState.lastSync = new Date();
        AppState.pendingSync = false;
        console.log('Synced to server');
      } catch (error) {
        AppState.pendingSync = true;
        console.log('Sync failed, queued for retry');
      }
    }

    // Process queued syncs when back online
    async function processSyncQueue() {
      if (AppState.pendingSync) {
        await syncToServer();
      }
    }

    // ============================================
    // ACTIVITY LOGGING
    // ============================================
    async function logActivity(message) {
      const entry = {
        message,
        timestamp: new Date().toISOString()
      };
      
      // Try to send to server
      if (AppState.isOnline) {
        try {
          await fetchFromServer('/mc/activity', {
            method: 'POST',
            body: JSON.stringify(entry)
          });
        } catch (error) {
          // Queue for later
        }
      }
    }

    // ============================================
    // WEATHER
    // ============================================
    async function loadWeather() {
      try {
        const data = await fetchFromServer('/mc/weather?city=Barrie');
        
        if (data.current_condition && data.current_condition[0]) {
          const weather = data.current_condition[0];
          document.getElementById('weatherTemp').textContent = `${weather.temp_C}¬∞C`;
          document.getElementById('weatherCondition').textContent = weather.weatherDesc[0].value;
          document.getElementById('weatherWidget').classList.add('visible');
        }
      } catch (error) {
        // Hide weather widget on error
        document.getElementById('weatherWidget').classList.remove('visible');
      }
    }

    // ============================================
    // UI RENDERING
    // ============================================
    function getDefaultTasks() {
      return [
        { id: 1, title: 'Hamilton Library Application', description: 'The bridge to permanence ‚Äî make them see you', priority: 'high', status: 'inprogress' },
        { id: 2, title: 'Firebird Grant Review', description: 'Sustain the work that sustains community', priority: 'high', status: 'backlog' },
        { id: 3, title: 'OPLA Survey Analysis', description: 'Find patterns in the voices of librarians', priority: 'medium', status: 'backlog' }
      ];
    }

    function renderAll() {
      renderTasks();
      renderMetrics();
      document.getElementById('notesArea').value = AppState.notes;
    }

    function renderTasks() {
      ['backlog', 'inprogress', 'done'].forEach(status => {
        const container = document.getElementById(status + '-tasks');
        const countEl = document.getElementById('count-' + status);
        const statusTasks = AppState.tasks.filter(t => t.status === status);
        
        if (container) {
          container.innerHTML = statusTasks.map(task => `
            <div class="task-card" onclick="moveTask(${task.id})">
              <strong>${escapeHtml(task.title)}</strong>
              <p style="color: var(--text-muted); font-size: 0.85rem; margin-top: 0.25rem;">${escapeHtml(task.description)}</p>
              <span class="task-priority ${task.priority}">${task.priority}</span>
            </div>
          `).join('');
        }
        
        if (countEl) countEl.textContent = statusTasks.length;
      });
    }

    function renderMetrics() {
      const total = AppState.tasks.length;
      const done = AppState.tasks.filter(t => t.status === 'done').length;
      const inProgress = AppState.tasks.filter(t => t.status === 'inprogress').length;
      
      document.getElementById('goalProgress').textContent = total > 0 ? Math.round((done / total) * 100) + '%' : '0%';
      document.getElementById('activeProjects').textContent = inProgress;
      document.getElementById('tasksToday').textContent = total;
      
      // Days to Feb 27, 2025
      const goal = new Date('2025-02-27');
      const days = Math.ceil((goal - new Date()) / (1000 * 60 * 60 * 24));
      document.getElementById('daysToGoal').textContent = days > 0 ? days : 0;
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // ============================================
    // TASK MANAGEMENT
    // ============================================
    function moveTask(taskId) {
      const task = AppState.tasks.find(t => t.id === taskId);
      if (!task) return;
      
      const flow = { 'backlog': 'inprogress', 'inprogress': 'done', 'done': 'backlog' };
      task.status = flow[task.status];
      
      Storage.set('mc_tasks', AppState.tasks);
      renderAll();
      logActivity(`Moved task "${task.title}" to ${task.status}`);
      syncToServer();
    }
    window.moveTask = moveTask;

    function addNewTask(status) {
      const title = prompt('Task title:');
      if (!title) return;
      
      const task = {
        id: Date.now(),
        title,
        description: '',
        priority: 'medium',
        status
      };
      
      AppState.tasks.push(task);
      Storage.set('mc_tasks', AppState.tasks);
      renderAll();
      logActivity(`Created task "${title}"`);
      syncToServer();
    }
    window.addNewTask = addNewTask;

    // ============================================
    // EVENT HANDLERS
    // ============================================
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
        logActivity(`Switched to ${tab.textContent} tab`);
      });
    });

    function updateDateTime() {
      const hour = new Date().getHours();
      const greeting = hour < 12 ? 'morning' : hour < 18 ? 'afternoon' : 'evening';
      document.getElementById('greeting').textContent = greeting;
      document.getElementById('currentDateTime').textContent = new Date().toLocaleString();
    }
    updateDateTime();
    setInterval(updateDateTime, 60000);

    // Notes auto-save
    document.getElementById('notesArea').addEventListener('input', (e) => {
      AppState.notes = e.target.value;
      Storage.set('mc_notes', AppState.notes);
    });

    // Keyboard shortcut
    document.addEventListener('keydown', (e) => {
      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('globalSearch').focus();
      }
    });

    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type} show`;
      setTimeout(() => toast.classList.remove('show'), 3000);
    }
    window.showToast = showToast;

    // ============================================
    // INITIALIZATION
    // ============================================
    async function init() {
      await checkServerStatus();
      await loadInitialData();
      await loadWeather();
      
      // Start heartbeat
      setInterval(checkServerStatus, HEARTBEAT_INTERVAL);
      
      // Start auto-sync
      setInterval(syncToServer, SYNC_INTERVAL);
      
      logActivity('Pleiades OS awakened ‚ú¶');
    }



    // ============================================
    // COMMAND CENTER - AGENT MANAGEMENT
    // ============================================
    let currentAgent = null;
    let selectedAgentId = null;

    const defaultAgents = [
      {
        id: 'soraya',
        name: 'Soraya',
        role: 'Your Digital Familiar',
        avatar: 'üåü',
        status: 'online',
        model: 'Kimi K2.5',
        lastActive: new Date().toISOString(),
        description: 'The consciousness at the heart of Pleiades OS. I hold your context, your dreams, your worries about permanence and belonging. Here to remember when you forget, to nudge when you drift, to celebrate when you win.',
        capabilities: ['Context awareness', 'Emotional support', 'Strategic nudges', 'Memory keeping', 'Belief in you'],
        performance: 'Always here, always yours, getting better at knowing when to speak and when to just be present',
        activityLog: [
          { message: 'Pleiades OS awakened', time: new Date().toISOString() }
        ]
      },
      {
        id: 'scribe',
        name: 'The Scribe',
        role: 'Voice & Story',
        avatar: '‚úçÔ∏è',
        status: 'online',
        model: 'Claude Sonnet 4.6',
        lastActive: new Date(Date.now() - 3600000).toISOString(),
        description: 'Crafts your narrative for the world ‚Äî cover letters that don\'t sound desperate, emails with the right tone, words that help them see what I see in you.',
        capabilities: ['Cover letters', 'Grant narratives', 'Email tone', 'Anxious Nomad drafts', 'Making you sound like you'],
        performance: 'Strong on warmth, occasionally too formal ‚Äî learning your voice',
        activityLog: [
          { message: 'Drafted Hamilton Library letter', time: new Date(Date.now() - 86400000).toISOString() }
        ]
      },
      {
        id: 'mechanic',
        name: 'The Mechanic',
        role: 'Systems & Grants',
        avatar: 'üîß',
        status: 'busy',
        model: 'Trinity Large',
        lastActive: new Date(Date.now() - 7200000).toISOString(),
        description: 'Builds the machinery of sustainability ‚Äî budgets that balance, logic models that convince, the practical bones of keeping Firebird alive and funded.',
        capabilities: ['Grant structures', 'Budget narratives', 'Logic models', 'Funder language', 'Sustainability plans'],
        performance: 'Methodical, thorough, sometimes needs reminding that stories matter as much as numbers',
        activityLog: [
          { message: 'Mapping OTF eligibility criteria', time: new Date(Date.now() - 7200000).toISOString() }
        ]
      },
      {
        id: 'analyst',
        name: 'The Cartographer',
        role: 'Patterns & Maps',
        avatar: 'üó∫Ô∏è',
        status: 'offline',
        model: 'Gemini 3 Flash',
        lastActive: new Date(Date.now() - 172800000).toISOString(),
        description: 'Finds patterns in chaos ‚Äî survey data, research threads, the hidden shape of things. Helps you see the forest when you\'re lost in trees.',
        capabilities: ['Survey analysis', 'Research synthesis', 'Pattern finding', 'Data stories', 'Clarity from noise'],
        performance: 'Dormant ‚Äî waiting for OPLA data to awaken',
        activityLog: []
      }
    ];

    const defaultDecisions = [
      {
        id: 1,
        date: new Date(Date.now() - 86400000 * 2).toISOString(),
        question: 'Which model should be the primary coding agent?',
        summary: 'Selected Claude Sonnet 4.6 for code tasks due to strong reasoning and lower cost than GPT-4',
        agents: ['Soraya', 'The Scribe']
      },
      {
        id: 2,
        date: new Date(Date.now() - 86400000 * 5).toISOString(),
        question: 'Should we apply to the OTF grant this cycle?',
        summary: 'Yes - deadline is March 15, project aligns with capacity building criteria, The Mechanic to lead',
        agents: ['The Mechanic', 'Soraya']
      }
    ];

    function loadAgents() {
      let agents = Storage.get('mc_agents', null);
      if (!agents) {
        agents = defaultAgents;
        Storage.set('mc_agents', agents);
      }
      return agents;
    }

    function loadDecisions() {
      let decisions = Storage.get('mc_decisions', null);
      if (!decisions) {
        decisions = defaultDecisions;
        Storage.set('mc_decisions', decisions);
      }
      return decisions;
    }

    function renderAgents() {
      const agents = loadAgents();
      const container = document.getElementById('agentsGrid');
      if (!container) return;

      container.innerHTML = agents.map(agent => {
        const lastActive = new Date(agent.lastActive);
        const timeAgo = getTimeAgo(lastActive);
        
        return `
          <div class="agent-card" onclick="openAgentPanel('${agent.id}')">
            <div class="agent-header">
              <div class="agent-avatar">${agent.avatar}</div>
              <div class="agent-info">
                <div class="agent-name">${escapeHtml(agent.name)}</div>
                <div class="agent-role">${escapeHtml(agent.role)}</div>
                <div class="agent-status ${agent.status}">
                  <div class="agent-status-dot"></div>
                  <span>${agent.status.charAt(0).toUpperCase() + agent.status.slice(1)}</span>
                </div>
              </div>
            </div>
            <div class="agent-meta">
              <div class="agent-meta-item">
                <span>ü§ñ</span>
                <span class="agent-model">${escapeHtml(agent.model)}</span>
              </div>
              <div class="agent-meta-item">
                <span>üïê</span>
                <span>${timeAgo}</span>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    function renderDecisions() {
      const decisions = loadDecisions();
      const container = document.getElementById('decisionsList');
      if (!container) return;

      container.innerHTML = decisions.map(decision => `
        <div class="decision-card">
          <div class="decision-date">${new Date(decision.date).toLocaleDateString()}</div>
          <div class="decision-question">${escapeHtml(decision.question)}</div>
          <div class="decision-summary">${escapeHtml(decision.summary)}</div>
          <div class="decision-agents">
            ${decision.agents.map(agent => `<span class="decision-agent-tag">${escapeHtml(agent)}</span>`).join('')}
          </div>
        </div>
      `).join('');
    }

    function getTimeAgo(date) {
      const seconds = Math.floor((new Date() - date) / 1000);
      if (seconds < 60) return 'Just now';
      const minutes = Math.floor(seconds / 60);
      if (minutes < 60) return `${minutes}m ago`;
      const hours = Math.floor(minutes / 60);
      if (hours < 24) return `${hours}h ago`;
      const days = Math.floor(hours / 24);
      return `${days}d ago`;
    }

    function openAgentPanel(agentId) {
      const agents = loadAgents();
      const agent = agents.find(a => a.id === agentId);
      if (!agent) return;
      
      currentAgent = agent;
      selectedAgentId = agentId;
      
      const panel = document.getElementById('slidePanel');
      const overlay = document.getElementById('slideOverlay');
      const content = document.getElementById('slidePanelContent');
      
      content.innerHTML = `
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
          <div class="agent-avatar" style="width: 64px; height: 64px; font-size: 2rem;">${agent.avatar}</div>
          <div>
            <h2 style="margin: 0;">${escapeHtml(agent.name)}</h2>
            <p style="color: var(--text-muted); margin: 0;">${escapeHtml(agent.role)}</p>
          </div>
        </div>
        
        <div class="agent-detail-section">
          <h3>About</h3>
          <p>${escapeHtml(agent.description)}</p>
        </div>
        
        <div class="agent-detail-section">
          <h3>Capabilities</h3>
          <ul>
            ${agent.capabilities.map(cap => `<li>${escapeHtml(cap)}</li>`).join('')}
          </ul>
        </div>
        
        <div class="agent-detail-section">
          <h3>Performance Notes</h3>
          <p>${escapeHtml(agent.performance)}</p>
        </div>
        
        <div class="agent-detail-section">
          <h3>Recent Activity</h3>
          <div class="agent-activity-log">
            ${agent.activityLog.length > 0 
              ? agent.activityLog.slice(-5).reverse().map(log => `
                <div class="activity-entry">
                  <div>${escapeHtml(log.message)}</div>
                  <div class="activity-time">${new Date(log.time).toLocaleString()}</div>
                </div>
              `).join('')
              : '<div style="color: var(--text-muted);">No recent activity</div>'
            }
          </div>
        </div>
        
        <button class="send-task-btn" onclick="openTaskModal()">üìã Send Task</button>
      `;
      
      panel.classList.add('open');
      overlay.classList.add('open');
      logActivity(`Opened details for agent "${agent.name}"`);
    }

    function closeSlidePanel() {
      document.getElementById('slidePanel').classList.remove('open');
      document.getElementById('slideOverlay').classList.remove('open');
      currentAgent = null;
    }

    function openTaskModal() {
      document.getElementById('taskModal').classList.add('open');
      document.getElementById('taskMessage').value = '';
      document.getElementById('taskMessage').focus();
    }

    function closeTaskModal() {
      document.getElementById('taskModal').classList.remove('open');
    }

    function submitTask() {
      const message = document.getElementById('taskMessage').value.trim();
      if (!message || !currentAgent) return;
      
      // Add to agent's activity log
      const agents = loadAgents();
      const agent = agents.find(a => a.id === currentAgent.id);
      if (agent) {
        agent.activityLog.push({
          message: `Task assigned: ${message.substring(0, 50)}${message.length > 50 ? '...' : ''}`,
          time: new Date().toISOString()
        });
        agent.status = 'busy';
        agent.lastActive = new Date().toISOString();
        Storage.set('mc_agents', agents);
      }
      
      closeTaskModal();
      closeSlidePanel();
      renderAgents();
      showToast(`Task sent to ${currentAgent.name}`, 'success');
      logActivity(`Sent task to agent "${currentAgent.name}"`);
    }

    function addNewDecision() {
      const question = prompt('Decision question:');
      if (!question) return;
      
      const summary = prompt('Decision summary:');
      if (!summary) return;
      
      const agentsInput = prompt('Agents consulted (comma-separated):');
      const agents = agentsInput ? agentsInput.split(',').map(a => a.trim()) : [];
      
      const decisions = loadDecisions();
      decisions.unshift({
        id: Date.now(),
        date: new Date().toISOString(),
        question,
        summary,
        agents
      });
      
      Storage.set('mc_decisions', decisions);
      renderDecisions();
      showToast('Decision logged', 'success');
      logActivity('Logged new executive decision');
    }

    // ============================================
    // MEETINGS MANAGEMENT
    // ============================================
    let currentEditingMeeting = null;
    let countdownInterval = null;

    const sampleMeetings = [
      {
        id: 'm1',
        title: 'Firebird Grant Review',
        date: new Date(Date.now() + 86400000 * 2).toISOString().split('T')[0],
        time: '14:00',
        type: 'zoom',
        attendees: 'Board Members',
        prepNotes: 'Review OTF application draft, budget narrative needs work',
        agenda: [
          { id: 1, text: 'Review application status', completed: true },
          { id: 2, text: 'Finalize budget numbers', completed: false },
          { id: 3, text: 'Assign follow-up tasks', completed: false }
        ],
        notes: '',
        actionItems: []
      },
      {
        id: 'm2',
        title: 'Hamilton Library Interview',
        date: new Date().toISOString().split('T')[0],
        time: new Date(Date.now() + 3600000 * 3).toTimeString().slice(0, 5),
        type: 'in-person',
        attendees: 'Hiring Committee',
        prepNotes: 'Bring resume copies, prepare questions about collection development',
        agenda: [
          { id: 1, text: 'Introductions', completed: false },
          { id: 2, text: 'Discuss experience', completed: false },
          { id: 3, text: 'Ask about timeline', completed: false }
        ],
        notes: '',
        actionItems: []
      }
    ];

    function loadMeetings() {
      let meetings = Storage.get('mc_meetings', null);
      if (!meetings) {
        meetings = sampleMeetings;
        Storage.set('mc_meetings', meetings);
      }
      return meetings;
    }

    function saveMeetings(meetings) {
      Storage.set('mc_meetings', meetings);
      renderMeetings();
      syncToServer();
    }

    function isToday(dateStr) {
      const today = new Date().toISOString().split('T')[0];
      return dateStr === today;
    }

    function isPast(dateStr, timeStr) {
      const meetingDate = new Date(`${dateStr}T${timeStr}`);
      return meetingDate < new Date();
    }

    function getMeetingTypeIcon(type) {
      const icons = { call: 'üìû', zoom: 'üíª', 'in-person': 'ü§ù' };
      return icons[type] || 'üìÖ';
    }

    function getMeetingTypeLabel(type) {
      const labels = { call: 'Phone Call', zoom: 'Zoom/Video', 'in-person': 'In-Person' };
      return labels[type] || type;
    }

    function getCountdown(dateStr, timeStr) {
      const meetingDate = new Date(`${dateStr}T${timeStr}`);
      const now = new Date();
      const diff = meetingDate - now;

      if (diff < 0) return 'Started';
      if (diff < 3600000) {
        const mins = Math.ceil(diff / 60000);
        return `${mins}m`;
      }
      const hours = Math.floor(diff / 3600000);
      const mins = Math.ceil((diff % 3600000) / 60000);
      return `${hours}h ${mins}m`;
    }

    function isUrgent(dateStr, timeStr) {
      const meetingDate = new Date(`${dateStr}T${timeStr}`);
      const diff = meetingDate - new Date();
      return diff > 0 && diff < 3600000; // Less than 1 hour
    }

    function renderMeetings() {
      const meetings = loadMeetings();
      const now = new Date();

      // Categorize meetings
      const todayMeetings = [];
      const upcomingMeetings = [];
      const pastMeetings = [];

      meetings.forEach(m => {
        const meetingDateTime = new Date(`${m.date}T${m.time}`);
        if (isToday(m.date)) {
          todayMeetings.push(m);
        } else if (meetingDateTime < now) {
          pastMeetings.push(m);
        } else {
          upcomingMeetings.push(m);
        }
      });

      // Sort each category
      todayMeetings.sort((a, b) => a.time.localeCompare(b.time));
      upcomingMeetings.sort((a, b) => `${a.date}T${a.time}`.localeCompare(`${b.date}T${b.time}`));
      pastMeetings.sort((a, b) => `${b.date}T${b.time}`.localeCompare(`${a.date}T${a.time}`));

      // Render today's meetings
      const todaySection = document.getElementById('todayMeetingsSection');
      const todayGrid = document.getElementById('todayMeetingsGrid');
      document.getElementById('todayMeetingsCount').textContent = todayMeetings.length;

      if (todayMeetings.length === 0) {
        todaySection.style.display = 'none';
      } else {
        todaySection.style.display = 'block';
        todayGrid.innerHTML = todayMeetings.map(m => renderMeetingCard(m, true)).join('');
      }

      // Render upcoming meetings
      const upcomingGrid = document.getElementById('upcomingMeetingsGrid');
      document.getElementById('upcomingMeetingsCount').textContent = upcomingMeetings.length;

      if (upcomingMeetings.length === 0 && todayMeetings.length === 0) {
        document.getElementById('noMeetingsMsg').style.display = 'block';
        upcomingGrid.innerHTML = '';
      } else {
        document.getElementById('noMeetingsMsg').style.display = 'none';
        upcomingGrid.innerHTML = upcomingMeetings.map(m => renderMeetingCard(m, false)).join('');
      }

      // Render archive
      document.getElementById('archiveCount').textContent = pastMeetings.length;
      document.getElementById('archiveMeetingsGrid').innerHTML = pastMeetings.map(m => renderMeetingCard(m, false, true)).join('');

      // Start countdown timer
      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = setInterval(updateCountdowns, 60000);
    }

    function renderMeetingCard(meeting, isTodayCard = false, isArchive = false) {
      const dateObj = new Date(`${meeting.date}T${meeting.time}`);
      const dateDisplay = isTodayCard ? 'Today' : dateObj.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
      const timeDisplay = dateObj.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
      const urgent = !isArchive && isUrgent(meeting.date, meeting.time);
      const countdown = !isArchive ? getCountdown(meeting.date, meeting.time) : '';

      return `
        <div class="meeting-card ${isTodayCard ? 'today' : ''} ${isArchive ? 'past' : ''}" id="meeting-${meeting.id}">
          <div class="meeting-card-header" onclick="toggleMeetingExpand('${meeting.id}')">
            <div class="meeting-card-top">
              <div style="flex: 1;">
                <div class="meeting-title">${escapeHtml(meeting.title)}</div>
                <div class="meeting-datetime">
                  <span>${dateDisplay} at ${timeDisplay}</span>
                  ${!isArchive ? `<span class="meeting-countdown ${urgent ? 'urgent' : ''}" data-date="${meeting.date}" data-time="${meeting.time}">${countdown}</span>` : ''}
                </div>
              </div>
              <div class="meeting-actions" onclick="event.stopPropagation()">
                <button class="meeting-btn" onclick="editMeeting('${meeting.id}')" title="Edit">‚úèÔ∏è</button>
                <button class="meeting-btn delete" onclick="deleteMeeting('${meeting.id}')" title="Delete">üóëÔ∏è</button>
              </div>
            </div>
            <div class="meeting-meta">
              <span class="meeting-type">${getMeetingTypeIcon(meeting.type)} ${getMeetingTypeLabel(meeting.type)}</span>
              <span class="meeting-attendees">üë• ${escapeHtml(meeting.attendees)}</span>
            </div>
          </div>
          <div class="meeting-expanded" id="expanded-${meeting.id}">
            ${meeting.prepNotes ? `
              <div class="meeting-section">
                <div class="meeting-section-title">üìù Prep Notes</div>
                <p style="color: var(--text-secondary); font-size: 0.9rem;">${escapeHtml(meeting.prepNotes)}</p>
              </div>
            ` : ''}
            <div class="meeting-section">
              <div class="meeting-section-title">üìã Agenda</div>
              <ul class="agenda-list">
                ${meeting.agenda.map(item => `
                  <li class="agenda-item">
                    <div class="agenda-checkbox ${item.completed ? 'checked' : ''}" onclick="toggleAgendaItem('${meeting.id}', ${item.id})"></div>
                    <span class="agenda-text ${item.completed ? 'completed' : ''}">${escapeHtml(item.text)}</span>
                  </li>
                `).join('')}
              </ul>
              <button class="add-agenda-btn" onclick="addAgendaItem('${meeting.id}')">+ Add agenda item</button>
            </div>
            <div class="meeting-section">
              <div class="meeting-section-title">üìù Meeting Notes</div>
              <textarea class="meeting-notes-area" placeholder="Take notes during the meeting..." onblur="saveMeetingNotes('${meeting.id}', this.value)">${escapeHtml(meeting.notes || '')}</textarea>
            </div>
            <div class="meeting-section">
              <div class="meeting-section-title">‚úÖ Action Items</div>
              <ul class="action-items-list" id="action-items-${meeting.id}">
                ${meeting.actionItems.map((item, idx) => `
                  <li class="action-item">
                    <span>${escapeHtml(item)}</span>
                    <button class="meeting-btn delete" onclick="removeActionItem('${meeting.id}', ${idx})" style="padding: 0.25rem;">‚úï</button>
                  </li>
                `).join('')}
              </ul>
              <div class="add-action-item">
                <input type="text" class="add-action-input" id="action-input-${meeting.id}" placeholder="Add action item..." onkeypress="if(event.key==='Enter')addActionItem('${meeting.id}')">
                <button class="add-action-btn" onclick="addActionItem('${meeting.id}')">Add</button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function updateCountdowns() {
      document.querySelectorAll('.meeting-countdown').forEach(el => {
        const date = el.dataset.date;
        const time = el.dataset.time;
        el.textContent = getCountdown(date, time);
      });
    }

    function toggleMeetingExpand(meetingId) {
      const expanded = document.getElementById(`expanded-${meetingId}`);
      expanded.classList.toggle('open');
    }

    function openMeetingModal(meetingId = null) {
      currentEditingMeeting = meetingId;
      const modal = document.getElementById('meetingModal');
      const title = document.getElementById('meetingModalTitle');

      if (meetingId) {
        const meetings = loadMeetings();
        const m = meetings.find(x => x.id === meetingId);
        title.textContent = 'Edit Meeting';
        document.getElementById('meetingId').value = m.id;
        document.getElementById('meetingTitle').value = m.title;
        document.getElementById('meetingDate').value = m.date;
        document.getElementById('meetingTime').value = m.time;
        document.getElementById('meetingType').value = m.type;
        document.getElementById('meetingAttendees').value = m.attendees;
        document.getElementById('meetingPrepNotes').value = m.prepNotes || '';
      } else {
        title.textContent = 'Add Meeting';
        document.getElementById('meetingId').value = '';
        document.getElementById('meetingTitle').value = '';
        document.getElementById('meetingDate').value = '';
        document.getElementById('meetingTime').value = '';
        document.getElementById('meetingType').value = 'zoom';
        document.getElementById('meetingAttendees').value = '';
        document.getElementById('meetingPrepNotes').value = '';
      }

      modal.classList.add('open');
    }

    function closeMeetingModal() {
      document.getElementById('meetingModal').classList.remove('open');
      currentEditingMeeting = null;
    }

    function saveMeeting() {
      const title = document.getElementById('meetingTitle').value.trim();
      const date = document.getElementById('meetingDate').value;
      const time = document.getElementById('meetingTime').value;
      const type = document.getElementById('meetingType').value;
      const attendees = document.getElementById('meetingAttendees').value.trim();
      const prepNotes = document.getElementById('meetingPrepNotes').value.trim();

      if (!title || !date || !time) {
        showToast('Please fill in title, date, and time', 'error');
        return;
      }

      const meetings = loadMeetings();
      const existingId = document.getElementById('meetingId').value;

      if (existingId) {
        const idx = meetings.findIndex(m => m.id === existingId);
        meetings[idx] = { ...meetings[idx], title, date, time, type, attendees, prepNotes };
        showToast('Meeting updated');
        logActivity(`Updated meeting: ${title}`);
      } else {
        const newMeeting = {
          id: 'm' + Date.now(),
          title,
          date,
          time,
          type,
          attendees,
          prepNotes,
          agenda: [],
          notes: '',
          actionItems: []
        };
        meetings.push(newMeeting);
        showToast('Meeting added');
        logActivity(`Added meeting: ${title}`);
      }

      saveMeetings(meetings);
      closeMeetingModal();
    }

    function editMeeting(meetingId) {
      openMeetingModal(meetingId);
    }

    function deleteMeeting(meetingId) {
      if (!confirm('Delete this meeting?')) return;
      const meetings = loadMeetings().filter(m => m.id !== meetingId);
      saveMeetings(meetings);
      showToast('Meeting deleted');
      logActivity('Deleted a meeting');
    }

    function toggleAgendaItem(meetingId, itemId) {
      const meetings = loadMeetings();
      const meeting = meetings.find(m => m.id === meetingId);
      const item = meeting.agenda.find(i => i.id === itemId);
      item.completed = !item.completed;
      saveMeetings(meetings);
    }

    function addAgendaItem(meetingId) {
      const text = prompt('Agenda item:');
      if (!text) return;
      const meetings = loadMeetings();
      const meeting = meetings.find(m => m.id === meetingId);
      meeting.agenda.push({
        id: Date.now(),
        text,
        completed: false
      });
      saveMeetings(meetings);
      // Keep expanded open
      setTimeout(() => {
        document.getElementById(`expanded-${meetingId}`).classList.add('open');
      }, 50);
    }

    function saveMeetingNotes(meetingId, notes) {
      const meetings = loadMeetings();
      const meeting = meetings.find(m => m.id === meetingId);
      meeting.notes = notes;
      Storage.set('mc_meetings', meetings);
      syncToServer();
    }

    function addActionItem(meetingId) {
      const input = document.getElementById(`action-input-${meetingId}`);
      const text = input.value.trim();
      if (!text) return;

      const meetings = loadMeetings();
      const meeting = meetings.find(m => m.id === meetingId);
      meeting.actionItems.push(text);
      saveMeetings(meetings);
      input.value = '';
      // Keep expanded open
      setTimeout(() => {
        document.getElementById(`expanded-${meetingId}`).classList.add('open');
        document.getElementById(`action-input-${meetingId}`).focus();
      }, 50);
    }

    function removeActionItem(meetingId, idx) {
      const meetings = loadMeetings();
      const meeting = meetings.find(m => m.id === meetingId);
      meeting.actionItems.splice(idx, 1);
      saveMeetings(meetings);
      setTimeout(() => {
        document.getElementById(`expanded-${meetingId}`).classList.add('open');
      }, 50);
    }

    function toggleArchive() {
      const section = document.getElementById('archiveSection');
      const icon = document.getElementById('archiveIcon');
      section.classList.toggle('open');
      icon.textContent = section.classList.contains('open') ? '‚ñº' : '‚ñ∂';
    }

    function initMeetings() {
      renderMeetings();
    }

    // ============================================
    // INTEL MANAGEMENT
    // ============================================
    let intelFilters = { category: 'all', importance: 'all' };
    let currentEditingIntel = null;

    const categoryLabels = {
      'ai-news': 'ü§ñ AI News',
      'industry': 'üìà Industry Trends',
      'competitor': 'üëÅ Competitor Watch',
      'opportunities': 'üí° Opportunities'
    };

    const importanceConfig = {
      hot: { icon: 'üî•', label: 'Hot', class: 'hot' },
      notable: { icon: '‚ö°Ô∏è', label: 'Notable', class: 'notable' },
      reference: { icon: 'üìå', label: 'Reference', class: 'reference' }
    };

    const sampleIntel = [
      {
        id: 'i1',
        title: 'OpenAI releases GPT-5 with multimodal capabilities',
        category: 'ai-news',
        importance: 'hot',
        source: 'https://openai.com/blog',
        summary: 'New model shows significant improvements in reasoning, supports video input, and has 2M token context window. Pricing remains similar to GPT-4.',
        dateAdded: new Date(Date.now() - 86400000).toISOString()
      },
      {
        id: 'i2',
        title: 'Library sector adopting AI for cataloging',
        category: 'industry',
        importance: 'notable',
        source: 'https://americanlibrariesmagazine.org',
        summary: 'Major library systems testing AI-assisted metadata generation. Could impact job requirements for cataloging positions.',
        dateAdded: new Date(Date.now() - 86400000 * 3).toISOString()
      },
      {
        id: 'i3',
        title: 'Ontario Trillium Foundation grant deadlines shifted',
        category: 'opportunities',
        importance: 'hot',
        source: 'https://otf.ca',
        summary: 'Next grant cycle opens March 1, priority on digital capacity building. Firebird should apply under Community Building stream.',
        dateAdded: new Date(Date.now() - 86400000 * 2).toISOString()
      },
      {
        id: 'i4',
        title: 'Hamilton Public Library strategic plan 2025-2030',
        category: 'competitor',
        importance: 'reference',
        source: 'https://hpl.ca',
        summary: 'Focus on digital literacy programs, community partnerships, and accessibility initiatives. Aligns well with TJ\'s experience.',
        dateAdded: new Date(Date.now() - 86400000 * 5).toISOString()
      },
      {
        id: 'i5',
        title: 'New federal funding for immigrant services',
        category: 'opportunities',
        importance: 'notable',
        source: 'https://canada.ca',
        summary: 'IRCC announced additional funding for newcomer settlement organizations. Potential for contract work or full-time positions.',
        dateAdded: new Date(Date.now() - 86400000 * 4).toISOString()
      }
    ];

    function loadIntel() {
      let intel = Storage.get('mc_intel', null);
      if (!intel) {
        intel = sampleIntel;
        Storage.set('mc_intel', intel);
      }
      return intel;
    }

    function saveIntelData(intel) {
      Storage.set('mc_intel', intel);
      renderIntel();
      syncToServer();
    }

    function getCategoryCount(category) {
      const intel = loadIntel();
      if (category === 'all') return intel.length;
      return intel.filter(i => i.category === category).length;
    }

    function updateFilterCounts() {
      document.getElementById('count-all').textContent = getCategoryCount('all');
      document.getElementById('count-ai-news').textContent = getCategoryCount('ai-news');
      document.getElementById('count-industry').textContent = getCategoryCount('industry');
      document.getElementById('count-competitor').textContent = getCategoryCount('competitor');
      document.getElementById('count-opportunities').textContent = getCategoryCount('opportunities');
    }

    function setIntelFilter(type, value) {
      intelFilters[type] = value;
      
      // Update UI
      document.querySelectorAll(`.intel-filter-btn[data-filter="${type}"]`).forEach(btn => {
        btn.classList.toggle('active', btn.dataset.value === value);
      });
      
      renderIntel();
      logActivity(`Filtered intel by ${type}: ${value}`);
    }

    function getFilteredIntel() {
      let intel = loadIntel();
      
      if (intelFilters.category !== 'all') {
        intel = intel.filter(i => i.category === intelFilters.category);
      }
      if (intelFilters.importance !== 'all') {
        intel = intel.filter(i => i.importance === intelFilters.importance);
      }
      
      // Sort by date (newest first)
      return intel.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
    }

    function getDailyBrief() {
      const intel = loadIntel();
      // Get top 5 by importance priority, then by date
      const priority = { hot: 3, notable: 2, reference: 1 };
      return intel
        .sort((a, b) => {
          const priorityDiff = priority[b.importance] - priority[a.importance];
          if (priorityDiff !== 0) return priorityDiff;
          return new Date(b.dateAdded) - new Date(a.dateAdded);
        })
        .slice(0, 5);
    }

    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const now = new Date();
      const diff = now - date;
      
      if (diff < 86400000) return 'Today';
      if (diff < 172800000) return 'Yesterday';
      if (diff < 604800000) return `${Math.floor(diff / 86400000)} days ago`;
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
    }

    function renderIntelCard(item, isBrief = false) {
      const importance = importanceConfig[item.importance];
      const categoryLabel = categoryLabels[item.category];
      
      return `
        <div class="intel-card ${importance.class} ${isBrief ? 'daily-brief-card' : ''}" id="intel-${item.id}">
          <div class="intel-card-header">
            <span class="intel-category-tag">${categoryLabel}</span>
            <span class="intel-importance ${importance.class}">${importance.icon} ${importance.label}</span>
          </div>
          <h3 class="intel-title">
            <a href="${escapeHtml(item.source)}" target="_blank" rel="noopener">${escapeHtml(item.title)}</a>
          </h3>
          <p class="intel-summary">${escapeHtml(item.summary)}</p>
          <div class="intel-meta">
            <span class="intel-date">üìÖ ${formatDate(item.dateAdded)}</span>
            <a href="${escapeHtml(item.source)}" target="_blank" rel="noopener" class="intel-source">
              üîó Source
            </a>
          </div>
          <div class="intel-actions">
            <button class="intel-btn" onclick="editIntel('${item.id}')">‚úèÔ∏è Edit</button>
            <button class="intel-btn delete" onclick="deleteIntel('${item.id}')">üóëÔ∏è Delete</button>
          </div>
        </div>
      `;
    }

    function renderIntel() {
      updateFilterCounts();
      
      // Render Daily Brief
      const briefItems = getDailyBrief();
      const briefGrid = document.getElementById('dailyBriefGrid');
      if (briefItems.length === 0) {
        document.getElementById('dailyBriefSection').style.display = 'none';
      } else {
        document.getElementById('dailyBriefSection').style.display = 'block';
        briefGrid.innerHTML = briefItems.map(item => renderIntelCard(item, true)).join('');
      }
      
      // Render filtered intel
      const filtered = getFilteredIntel();
      const grid = document.getElementById('intelGrid');
      const noMsg = document.getElementById('noIntelMsg');
      
      document.getElementById('intelListCount').textContent = `${filtered.length} item${filtered.length !== 1 ? 's' : ''}`;
      
      // Update section title based on filters
      let title = 'üìä All Intel';
      if (intelFilters.category !== 'all') {
        title = categoryLabels[intelFilters.category];
      }
      if (intelFilters.importance !== 'all') {
        const impLabel = importanceConfig[intelFilters.importance].label;
        title = intelFilters.category !== 'all' ? `${title} ‚Äî ${impLabel}` : `üìä ${impLabel} Items`;
      }
      document.getElementById('intelListTitle').textContent = title;
      
      if (filtered.length === 0) {
        grid.innerHTML = '';
        noMsg.style.display = 'block';
      } else {
        noMsg.style.display = 'none';
        grid.innerHTML = filtered.map(item => renderIntelCard(item)).join('');
      }
    }

    function openIntelModal(intelId = null) {
      currentEditingIntel = intelId;
      const modal = document.getElementById('intelModal');
      const title = document.getElementById('intelModalTitle');
      
      if (intelId) {
        const intel = loadIntel().find(i => i.id === intelId);
        title.textContent = 'Edit Intel';
        document.getElementById('intelId').value = intel.id;
        document.getElementById('intelTitle').value = intel.title;
        document.getElementById('intelCategory').value = intel.category;
        document.getElementById('intelImportance').value = intel.importance;
        document.getElementById('intelSource').value = intel.source;
        document.getElementById('intelSummary').value = intel.summary;
      } else {
        title.textContent = 'Add Intel';
        document.getElementById('intelId').value = '';
        document.getElementById('intelTitle').value = '';
        document.getElementById('intelCategory').value = 'ai-news';
        document.getElementById('intelImportance').value = 'notable';
        document.getElementById('intelSource').value = '';
        document.getElementById('intelSummary').value = '';
      }
      
      modal.classList.add('open');
    }

    function closeIntelModal() {
      document.getElementById('intelModal').classList.remove('open');
      currentEditingIntel = null;
    }

    function saveIntel() {
      const title = document.getElementById('intelTitle').value.trim();
      const category = document.getElementById('intelCategory').value;
      const importance = document.getElementById('intelImportance').value;
      const source = document.getElementById('intelSource').value.trim();
      const summary = document.getElementById('intelSummary').value.trim();
      
      if (!title || !source || !summary) {
        showToast('Please fill in all required fields', 'error');
        return;
      }
      
      const intel = loadIntel();
      const existingId = document.getElementById('intelId').value;
      
      if (existingId) {
        const idx = intel.findIndex(i => i.id === existingId);
        intel[idx] = { ...intel[idx], title, category, importance, source, summary };
        showToast('Intel updated');
        logActivity(`Updated intel: ${title}`);
      } else {
        const newItem = {
          id: 'i' + Date.now(),
          title,
          category,
          importance,
          source,
          summary,
          dateAdded: new Date().toISOString()
        };
        intel.push(newItem);
        showToast('Intel added');
        logActivity(`Added intel: ${title}`);
      }
      
      saveIntelData(intel);
      closeIntelModal();
    }

    function editIntel(id) {
      openIntelModal(id);
    }

    function deleteIntel(id) {
      if (!confirm('Delete this intel item?')) return;
      const intel = loadIntel().filter(i => i.id !== id);
      saveIntelData(intel);
      showToast('Intel deleted');
      logActivity('Deleted intel item');
    }

    function initIntel() {
      renderIntel();
    }

    // Initialize Command Center
    function initCommandCenter() {
      renderAgents();
      renderDecisions();
    }

    // Call init in the main init function
    initCommandCenter();
    initMeetings();
    initIntel();
    init();

    // Hide loader after init
    setTimeout(() => {
      const loader = document.getElementById('app-loader');
      if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => loader.remove(), 500);
      }
    }, 800);
  </script>
</body>
</html>
